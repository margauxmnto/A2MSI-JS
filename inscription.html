<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inscription</title>
</head>

<body>

    <h2>Inscription</h2>
    <form id="inscriptionForm">
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Mot de passe" required>
        <label for="role">Rôle:</label>
        <select id="role">
            <option value="user">Utilisateur</option>
            <option value="admin">Administrateur</option>
        </select>
        <button type="submit">S'inscrire</button>
    </form>

    <!-- Intégration de Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.0.0/firebase-database.js"></script>
    <script src="firebase.js"></script> <!-- Fichier de config Firebase -->

    <script>
        document.getElementById("inscriptionForm").addEventListener("submit", function (event) {
            event.preventDefault(); // Empêche le rechargement de la page

            let email = document.getElementById("email").value;
            let password = document.getElementById("password").value;
            let role = document.getElementById("role").value;

            // Création de l’utilisateur avec Firebase Authentication
            firebase.auth().createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    let userId = userCredential.user.uid;

                    // Enregistrer l’utilisateur dans la base de données Firebase
                    firebase.database().ref('users/' + userId).set({
                        email: email,
                        role: role
                    });

                    alert("Inscription réussie !");
                    window.location.href = "connexion.html"; // Redirection vers la connexion
                })
                .catch((error) => {
                    alert("Erreur : " + error.message);
                });
        });
    </script>

</body>

</html>